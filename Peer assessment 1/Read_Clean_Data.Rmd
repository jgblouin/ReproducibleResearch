---
title: Peer Assessment 1
author: "jgblouin"
date: "Tuesday, September 09, 2014"
output: html_document
---
### 1. Loading and cleaning the Data

Ensure that the code is always visible.
```{r setoptions, echo=TRUE}
knitr::opts_chunk$set(echo=TRUE)
```

Load the necessary libraries.
```{r}
library(data.table)
library(ggplot2)
library(xtable)
```
The data is read from a CSV file activity.csv located in the folder "./Reproducible Research/Peer assessment 1/Data/activity.csv"

```{r}
activityData<-read.csv("C:/Users/SUPER JG/Documents/Coursera Data Science/ReproducibleResearch/Peer assessment 1/Data/activity.csv")
```
Examine the first lines of data using str(), head() and summary().
```{r}
head(activityData)
summary(activityData)
str(activityData)
```

This indicates the presence of NA values and the date format will be modified from Factor to Date.But first, save the data as a data table.
```{r}
activityDataTable<-data.table(activityData)
```
Convert the dates to a Date class.
```{r}
activityDataTable[, date := as.Date(date)]
```
###2. What is mean total number of steps taken per day?

For this part of the assignment, you can ignore the missing values in the dataset.

**1. Make a histogram of the total number of steps taken each day**

Find the number of steps for each day. Days with missing values will have NA.
```{r}
dailySteps<-activityDataTable[,list(totalsteps=sum(steps)),date]
```
Examine the head of dailySteps:
```{r}
head(dailySteps)
```
Draw the required histogram using ggplot2.
```{r}
ggplot(dailySteps,aes(x=totalsteps)) + geom_histogram(alpha = 1/2, binwidth = 1000)
```

**2. Calculate and report the mean and median total number of steps taken per day**

The median and the mean are calculated before imputing the NA values.
```{r}
medMean<-dailySteps[,list(n = .N, nValid = sum(!is.na(totalsteps)), mean = mean(totalsteps,na.rm = TRUE), median = median(totalsteps, na.rm = TRUE))]
```
The mean and median:
```{r}
medMean
```
NB: I tried to use xtable, but it did not work. Tried the presentation examples, also did not work. I will inquire when time permits....

###3. What is the average daily pattern?

**1. Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)**

The initial table activityDataTable includes 5 minute intervals.Use these intervals to make the required plot.
```{r}
ADTIntervals<-activityDataTable[,list(meanSteps=mean(steps,na.rm=TRUE)),interval]
```
Create the plot again using ggplot2 of the 5 minute intervals and the average number of steps takewn across the days.
```{r}
ggplot(ADTIntervals,aes(x=interval,y=meanSteps))+geom_line()
```

**2. Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?**

In first place, find the maximum value of meanSteps in ADTIntervals.
```{r}
maxStep<-max(ADTIntervals$meanSteps)
```
Then find which interval matches this value.
```{r}
ADTIntervals[which(ADTIntervals$meanSteps==maxStep)]
```

